(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{129:function(e,r,a){"use strict";a.r(r),a.d(r,"spec",(function(){return w}));var t=a(16),n=a(0),i=a(2),s=a(55),o=a(13),d=a(5),c=a(4),p=a.n(c),u=a(3),m=a.n(u),l=a(35);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(){return(v=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e}).apply(this,arguments)}function g(e){return function(e){if(Array.isArray(e)){for(var r=0,a=new Array(e.length);r<e.length;r++)a[r]=e[r];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var y="https://ib.adnxs.com/ut/v3/prebid",b=["id","mimes","minduration","maxduration","startdelay","skippable","playback_method","frameworks"],h=["age","externalUid","segments","gender","dnt","language"],_=["geo","device_id"],k=["enabled","dongle","member_id","debug_timeout"],I={body:"description",body2:"desc2",cta:"ctatext",image:{serverName:"main_image",requiredParams:{required:!0}},icon:{serverName:"icon",requiredParams:{required:!0}},sponsoredBy:"sponsored_by",privacyLink:"privacy_link",salePrice:"saleprice",displayUrl:"displayurl"},x=/\/\/cdn\.adnxs\.com\/v/,w={code:"appnexus",aliases:["appnexusAst","brealtime","emxdigital","pagescience","defymedia","gourmetads","matomy","featureforward","oftmedia","districtm","adasta"],supportedMediaTypes:[o.b,o.d,o.c],isBidRequestValid:function(e){return!!(e.params.placementId||e.params.member&&e.params.invCode)},buildRequests:function(e,r){var a=e.map(T),t=p()(e,R),s={};!0===i.b.getConfig("coppa")&&(s={coppa:!0}),t&&Object.keys(t.params.user).filter((function(e){return m()(h,e)})).forEach((function(e){return s[e]=t.params.user[e]}));var o,d=p()(e,P);d&&d.params&&d.params.app&&(o={},Object.keys(d.params.app).filter((function(e){return m()(_,e)})).forEach((function(e){return o[e]=d.params.app[e]})));var c,u=p()(e,j);u&&u.params&&d.params.app&&d.params.app.id&&(c={appid:u.params.app.id});var l={},f={},v=n.getCookie("apn_prebid_debug")||null;if(v)try{l=JSON.parse(v)}catch(e){n.logError("AppNexus Debug Auction Cookie Error:\n\n"+e)}else{var b=p()(e,N);b&&b.debug&&(l=b.debug)}l&&l.enabled&&Object.keys(l).filter((function(e){return m()(k,e)})).forEach((function(e){f[e]=l[e]}));var I=p()(e,O),x=I?parseInt(I.params.member,10):0,w=e[0].schain,A={tags:g(a),user:s,sdk:{source:"pbjs",version:"3.11.0"},schain:w};if(x>0&&(A.member_id=x),d&&(A.device=o),u&&(A.app=c),i.b.getConfig("adpod.brandCategoryExclusion")&&(A.brand_category_uniqueness=!0),f.enabled&&(A.debug=f,n.logInfo("AppNexus Debug Auction Settings:\n\n"+JSON.stringify(f,null,4))),r&&r.gdprConsent&&(A.gdpr_consent={consent_string:r.gdprConsent.consentString,consent_required:r.gdprConsent.gdprApplies}),r&&r.uspConsent&&(A.us_privacy=r.uspConsent),r&&r.refererInfo){var C={rd_ref:encodeURIComponent(r.refererInfo.referer),rd_top:r.refererInfo.reachedTop,rd_ifs:r.refererInfo.numIframes,rd_stk:r.refererInfo.stack.map((function(e){return encodeURIComponent(e)})).join(",")};A.referrer_detection=C}p()(e,U)&&e.filter(U).forEach((function(e){var r=function(e,r){var a=r.mediaTypes.video,t=a.durationRangeSec,i=a.requireExactDuration,s=function(e){var r=e.adPodDurationSec,a=e.durationRangeSec,t=e.requireExactDuration,i=n.getMinValueFromArray(a),s=Math.floor(r/i);return t?Math.max(s,a.length):s}(r.mediaTypes.video),o=n.getMaxValueFromArray(t),d=e.filter((function(e){return e.uuid===r.bidId})),c=n.fill.apply(n,g(d).concat([s]));if(i){var p=Math.ceil(s/t.length),u=n.chunk(c,p);t.forEach((function(e,r){u[r].map((function(r){q(r,"minduration",e),q(r,"maxduration",e)}))}))}else c.map((function(e){return q(e,"maxduration",o)}));return c}(a,e),t=A.tags.filter((function(r){return r.uuid!==e.bidId}));A.tags=[].concat(g(t),g(r))}));var S=n.deepAccess(e[0],"userId.criteoId");if(S){var E=[];E.push({provider:"criteo",user_id:S}),A.tpuids=E}return function(e,r){var a=[];if(e.tags.length>15){var t=n.deepClone(e);n.chunk(e.tags,15).forEach((function(e){t.tags=e;var n=JSON.stringify(t);a.push({method:"POST",url:y,data:n,bidderRequest:r})}))}else{var i=JSON.stringify(e);a={method:"POST",url:y,data:i,bidderRequest:r}}return a}(A,r)},interpretResponse:function(e,r){var a=this,i=r.bidderRequest;e=e.body;var d=[];if(!e||e.error){var c="in response for ".concat(i.bidderCode," adapter");return e&&e.error&&(c+=": ".concat(e.error)),n.logError(c),d}if(e.tags&&e.tags.forEach((function(e){var r,c=(r=e)&&r.ads&&r.ads.length&&p()(r.ads,(function(e){return e.rtb}));if(c&&0!==c.cpm&&m()(a.supportedMediaTypes,c.ad_type)){var u=function(e,r,a){var i=n.getBidRequest(e.uuid,[a]),d={requestId:e.uuid,cpm:r.cpm,creativeId:r.creative_id,dealId:r.deal_id,currency:"USD",netRevenue:!0,ttl:300,adUnitCode:i.adUnitCode,appnexus:{buyerMemberId:r.buyer_member_id,dealPriority:r.deal_priority,dealCode:r.deal_code}};r.advertiser_id&&(d.meta=v({},d.meta,{advertiserId:r.advertiser_id}));if(r.rtb.video){switch(v(d,{width:r.rtb.video.player_width,height:r.rtb.video.player_height,vastImpUrl:r.notify_url,ttl:3600}),n.deepAccess(i,"mediaTypes.video.context")){case o.a:var c=Object(s.getIabSubCategory)(i.bidder,r.brand_category_id);d.meta=v({},d.meta,{iabSubCatId:c});var u=r.rtb.dealPriority;d.video={context:o.a,durationSeconds:Math.floor(r.rtb.video.duration_ms/1e3),dealTier:u},d.vastUrl=r.rtb.video.asset_url;break;case l.b:if(d.adResponse=e,d.adResponse.ad=d.adResponse.ads[0],d.adResponse.ad.video=d.adResponse.ad.rtb.video,d.vastXml=r.rtb.video.content,r.renderer_url){var m=p()(a.bids,(function(r){return r.bidId===e.uuid})),f=n.deepAccess(m,"renderer.options");d.renderer=function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.a.install({id:r.renderer_id,url:r.renderer_url,config:a,loaded:!1,adUnitCode:e});try{i.setRender(z)}catch(e){n.logWarn("Prebid Error calling setRender on renderer",e)}return i.setEventHandlers({impression:function(){return n.logMessage("AppNexus outstream video impression event")},loaded:function(){return n.logMessage("AppNexus outstream video loaded event")},ended:function(){n.logMessage("AppNexus outstream renderer video event"),document.querySelector("#".concat(e)).style.display="none"}}),i}(d.adUnitCode,r,f)}break;case l.a:d.vastUrl=r.notify_url+"&redir="+encodeURIComponent(r.rtb.video.asset_url)}}else if(r.rtb[o.c]){var g=r.rtb[o.c],y=r.viewability.config.replace("src=","data-src="),b=g.javascript_trackers;null==b?b=y:n.isStr(b)?b=[b,y]:b.push(y),d[o.c]={title:g.title,body:g.desc,body2:g.desc2,cta:g.ctatext,rating:g.rating,sponsoredBy:g.sponsored,privacyLink:g.privacy_link,address:g.address,downloads:g.downloads,likes:g.likes,phone:g.phone,price:g.price,salePrice:g.saleprice,clickUrl:g.link.url,displayUrl:g.displayurl,clickTrackers:g.link.click_trackers,impressionTrackers:g.impression_trackers,javascriptTrackers:b},g.main_img&&(d.native.image={url:g.main_img.url,height:g.main_img.height,width:g.main_img.width}),g.icon&&(d.native.icon={url:g.icon.url,height:g.icon.height,width:g.icon.width})}else{v(d,{width:r.rtb.banner.width,height:r.rtb.banner.height,ad:r.rtb.banner.content});try{var h=r.rtb.trackers[0].impression_urls[0],_=n.createTrackPixelHtml(h);d.ad+=_}catch(e){n.logError("Error appending tracking pixel",e)}}return d}(e,c,i);u.mediaType=function(e){var r=e.ad_type;return r===o.d?o.d:r===o.c?o.c:o.b}(c),d.push(u)}})),e.debug&&e.debug.debug_info){var u="AppNexus Debug Auction for Prebid\n\n"+e.debug.debug_info;u=u.replace(/(<td>|<th>)/gm,"\t").replace(/(<\/td>|<\/th>)/gm,"\n").replace(/^<br>/gm,"").replace(/(<br>\n|<br>)/gm,"\n").replace(/<h1>(.*)<\/h1>/gm,"\n\n===== $1 =====\n\n").replace(/<h[2-6]>(.*)<\/h[2-6]>/gm,"\n\n*** $1 ***\n\n").replace(/(<([^>]+)>)/gim,""),n.logMessage("https://console.appnexus.com/docs/understanding-the-debug-auction"),n.logMessage(u)}return d},getMappingFileInfo:function(){return{url:"https://acdn.adnxs.com/prebid/appnexus-mapping/mappings.json",refreshInDays:7}},getUserSyncs:function(e){if(e.iframeEnabled)return[{type:"iframe",url:"https://acdn.adnxs.com/ib/static/usersync/v3/async_usersync.html"}]},transformBidParams:function(e,r){return e=n.convertTypes({member:"string",invCode:"string",placementId:"number",keywords:n.transformBidderParamKeywords},e),r&&(e.use_pmt_rule="boolean"==typeof e.usePaymentRule&&e.usePaymentRule,e.usePaymentRule&&delete e.usePaymentRule,A(e.keywords)&&e.keywords.forEach(C),Object.keys(e).forEach((function(r){var a=n.convertCamelToUnderscore(r);a!==r&&(e[a]=e[r],delete e[r])}))),e},onBidWon:function(e){e.native&&function(e){var r=function(e){var r;if(n.isStr(e)&&S(e))r=e;else if(n.isArray(e))for(var a=0;a<e.length;a++){var t=e[a];S(t)&&(r=t)}return r}(e.native.javascriptTrackers);if(r)for(var a="pbjs_adid="+e.adId+";pbjs_auc="+e.adUnitCode,t=function(e){var r=e.indexOf('src="')+5,a=e.indexOf('"',r);return e.substring(r,a)}(r),i=t.replace("dom_id=%native_dom_id%",a),s=document.getElementsByTagName("iframe"),o=!1,d=0;d<s.length&&!o;d++){var c=s[d];try{var p=c.contentDocument||c.contentWindow.document;if(p)for(var u=p.getElementsByTagName("script"),m=0;m<u.length&&!o;m++){var l=u[m];l.getAttribute("data-src")==t&&(l.setAttribute("src",i),l.setAttribute("data-src",""),l.removeAttribute&&l.removeAttribute("data-src"),o=!0)}}catch(e){if(!(e instanceof DOMException&&"SecurityError"===e.name))throw e}}}(e)}};function A(e){return!!(n.isArray(e)&&e.length>0)}function C(e){A(e.value)&&""===e.value[0]&&delete e.value}function S(e){var r=e.match(x),a=null!=r&&r.length>=1,t=e.match("trk.js"),n=null!=t&&t.length>=1;return e.startsWith("<script")&&n&&a}function T(e){var r,a,t={};if(t.sizes=E(e.sizes),t.primary_size=t.sizes[0],t.ad_types=[],t.uuid=e.bidId,e.params.placementId?t.id=parseInt(e.params.placementId,10):t.code=e.params.invCode,t.allow_smaller_sizes=e.params.allowSmallerSizes||!1,t.use_pmt_rule=e.params.usePaymentRule||!1,t.prebid=!0,t.disable_psa=!0,e.params.reserve&&(t.reserve=e.params.reserve),e.params.position&&(t.position={above:1,below:2}[e.params.position]||0),e.params.trafficSourceCode&&(t.traffic_source_code=e.params.trafficSourceCode),e.params.privateSizes&&(t.private_sizes=E(e.params.privateSizes)),e.params.supplyType&&(t.supply_type=e.params.supplyType),e.params.pubClick&&(t.pubclick=e.params.pubClick),e.params.extInvCode&&(t.ext_inv_code=e.params.extInvCode),e.params.externalImpId&&(t.external_imp_id=e.params.externalImpId),!n.isEmpty(e.params.keywords)){var i=n.transformBidderParamKeywords(e.params.keywords);i.length>0&&i.forEach(C),t.keywords=i}if((e.mediaType===o.c||n.deepAccess(e,"mediaTypes.".concat(o.c)))&&(t.ad_types.push(o.c),0===t.sizes.length&&(t.sizes=E([1,1])),e.nativeParams)){var s=(r=e.nativeParams,a={},Object.keys(r).forEach((function(e){var t=I[e]&&I[e].serverName||I[e]||e,i=I[e]&&I[e].requiredParams;if(a[t]=v({},i,r[e]),(t===I.image.serverName||t===I.icon.serverName)&&a[t].sizes){var s=a[t].sizes;(n.isArrayOfNums(s)||n.isArray(s)&&s.length>0&&s.every((function(e){return n.isArrayOfNums(e)})))&&(a[t].sizes=E(a[t].sizes))}t===I.privacyLink&&(a.privacy_supported=!0)})),a);t[o.c]={layouts:[s]}}var c=n.deepAccess(e,"mediaTypes.".concat(o.d)),u=n.deepAccess(e,"mediaTypes.video.context");(e.mediaType===o.d||c)&&t.ad_types.push(o.d),(e.mediaType===o.d||c&&"outstream"!==u)&&(t.require_asset_url=!0),e.params.video&&(t.video={},Object.keys(e.params.video).filter((function(e){return m()(b,e)})).forEach((function(r){return t.video[r]=e.params.video[r]}))),e.renderer&&(t.video=v({},t.video,{custom_renderer_present:!0}));var l=p()(d.a.getAdUnits(),(function(r){return e.transactionId===r.transactionId}));return l&&l.mediaTypes&&l.mediaTypes.banner&&t.ad_types.push(o.b),0===t.ad_types.length&&delete t.ad_types,t}function E(e){var r=[],a={};if(n.isArray(e)&&2===e.length&&!n.isArray(e[0]))a.width=parseInt(e[0],10),a.height=parseInt(e[1],10),r.push(a);else if("object"===f(e))for(var t=0;t<e.length;t++){var i=e[t];(a={}).width=parseInt(i[0],10),a.height=parseInt(i[1],10),r.push(a)}return r}function R(e){return!!e.params.user}function O(e){return!!parseInt(e.params.member,10)}function P(e){if(e.params)return!!e.params.app}function j(e){return e.params&&e.params.app?!!e.params.app.id:!!e.params.app}function N(e){return!!e.debug}function U(e){return e.mediaTypes&&e.mediaTypes.video&&e.mediaTypes.video.context===o.a}function q(e,r,a){n.isEmpty(e.video)&&(e.video={}),e.video[r]=a}function z(e){e.renderer.push((function(){window.ANOutstreamVideo.renderAd({tagId:e.adResponse.tag_id,sizes:[e.getSize().split("x")],targetId:e.adUnitCode,uuid:e.adResponse.uuid,adResponse:e.adResponse,rendererOptions:e.renderer.getConfig()},M.bind(null,e))}))}function M(e,r,a){e.renderer.handleVideoEvent({id:r,eventName:a})}Object(s.registerBidder)(w)}}]);