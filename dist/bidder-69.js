(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{294:function(e,r,t){"use strict";t.d(r,"a",(function(){return d}));var n=t(277),a=t(300),i=t(286),s=t.n(i),o=t(282);var d=function(){var e=[],r={};return r.addWinningBid=function(r){var t=s()(e,(function(e){return e.getAuctionId()===r.auctionId}));t?(r.status=o.BID_STATUS.RENDERED,t.addWinningBid(r)):Object(n.logWarn)("Auction not found when adding winning bid")},r.getAllWinningBids=function(){return e.map((function(e){return e.getWinningBids()})).reduce(n.flatten,[])},r.getBidsRequested=function(){return e.map((function(e){return e.getBidRequests()})).reduce(n.flatten,[])},r.getNoBids=function(){return e.map((function(e){return e.getNoBids()})).reduce(n.flatten,[])},r.getBidsReceived=function(){return e.map((function(e){if(e.getAuctionStatus()===a.a)return e.getBidsReceived()})).reduce(n.flatten,[]).filter((function(e){return e}))},r.getAdUnits=function(){return e.map((function(e){return e.getAdUnits()})).reduce(n.flatten,[])},r.getAdUnitCodes=function(){return e.map((function(e){return e.getAdUnitCodes()})).reduce(n.flatten,[]).filter(n.uniques)},r.createAuction=function(r){var t=r.adUnits,n=r.adUnitCodes,i=r.callback,s=r.cbTimeout,o=r.labels,d=r.auctionId,u=Object(a.k)({adUnits:t,adUnitCodes:n,callback:i,cbTimeout:s,labels:o,auctionId:d});return function(r){e.push(r)}(u),u},r.findBidByAdId=function(r){return s()(e.map((function(e){return e.getBidsReceived()})).reduce(n.flatten,[]),(function(e){return e.adId===r}))},r.getStandardBidderAdServerTargeting=function(){return Object(a.j)()[o.JSON_MAPPING.ADSERVER_TARGETING]},r.setStatusForBids=function(t,n){var a=r.findBidByAdId(t);if(a&&(a.status=n),a&&n===o.BID_STATUS.BID_TARGETING_SET){var i=s()(e,(function(e){return e.getAuctionId()===a.auctionId}));i&&i.setBidTargeting(a)}},r.getLastAuctionId=function(){return e.length&&e[e.length-1].getAuctionId()},r}()},51:function(e,r,t){"use strict";t.r(r),t.d(r,"spec",(function(){return T}));var n=t(287),a=t(277),i=t(280),s=t(278),o=t(279),d=t(294),u=t(286),c=t.n(u),p=t(283),l=t.n(p),m=t(316);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){return(g=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function v(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var b="https://ib.adnxs.com/ut/v3/prebid",y=["id","mimes","minduration","maxduration","startdelay","skippable","playback_method","frameworks"],h=["age","externalUid","segments","gender","dnt","language"],_=["geo","device_id"],I=["enabled","dongle","member_id","debug_timeout"],A={body:"description",body2:"desc2",cta:"ctatext",image:{serverName:"main_image",requiredParams:{required:!0}},icon:{serverName:"icon",requiredParams:{required:!0}},sponsoredBy:"sponsored_by",privacyLink:"privacy_link",salePrice:"saleprice",displayUrl:"displayurl"},k=/\/\/cdn\.adnxs\.com\/v/,T={code:"appnexus",aliases:["appnexusAst","brealtime","emxdigital","pagescience","defymedia","gourmetads","matomy","featureforward","oftmedia","districtm","adasta"],supportedMediaTypes:[o.b,o.d,o.c],isBidRequestValid:function(e){return!!(e.params.placementId||e.params.member&&e.params.invCode)},buildRequests:function(e,r){var t=e.map(R),n=c()(e,E),s={};!0===i.b.getConfig("coppa")&&(s={coppa:!0}),n&&Object.keys(n.params.user).filter((function(e){return l()(h,e)})).forEach((function(e){return s[e]=n.params.user[e]}));var o,d=c()(e,O);d&&d.params&&d.params.app&&(o={},Object.keys(d.params.app).filter((function(e){return l()(_,e)})).forEach((function(e){return o[e]=d.params.app[e]})));var u,p=c()(e,U);p&&p.params&&d.params.app&&d.params.app.id&&(u={appid:p.params.app.id});var m={},f={},g=a.getCookie("apn_prebid_debug")||null;if(g)try{m=JSON.parse(g)}catch(e){a.logError("AppNexus Debug Auction Cookie Error:\n\n"+e)}else{var y=c()(e,N);y&&y.debug&&(m=y.debug)}m&&m.enabled&&Object.keys(m).filter((function(e){return l()(I,e)})).forEach((function(e){f[e]=m[e]}));var A=c()(e,B),k=A?parseInt(A.params.member,10):0,T=e[0].schain,S={tags:v(t),user:s,sdk:{source:"pbjs",version:"3.11.0"},schain:T};if(k>0&&(S.member_id=k),d&&(S.device=o),p&&(S.app=u),i.b.getConfig("adpod.brandCategoryExclusion")&&(S.brand_category_uniqueness=!0),f.enabled&&(S.debug=f,a.logInfo("AppNexus Debug Auction Settings:\n\n"+JSON.stringify(f,null,4))),r&&r.gdprConsent&&(S.gdpr_consent={consent_string:r.gdprConsent.consentString,consent_required:r.gdprConsent.gdprApplies}),r&&r.uspConsent&&(S.us_privacy=r.uspConsent),r&&r.refererInfo){var w={rd_ref:encodeURIComponent(r.refererInfo.referer),rd_top:r.refererInfo.reachedTop,rd_ifs:r.refererInfo.numIframes,rd_stk:r.refererInfo.stack.map((function(e){return encodeURIComponent(e)})).join(",")};S.referrer_detection=w}c()(e,j)&&e.filter(j).forEach((function(e){var r=function(e,r){var t=r.mediaTypes.video,n=t.durationRangeSec,i=t.requireExactDuration,s=function(e){var r=e.adPodDurationSec,t=e.durationRangeSec,n=e.requireExactDuration,i=a.getMinValueFromArray(t),s=Math.floor(r/i);return n?Math.max(s,t.length):s}(r.mediaTypes.video),o=a.getMaxValueFromArray(n),d=e.filter((function(e){return e.uuid===r.bidId})),u=a.fill.apply(a,v(d).concat([s]));if(i){var c=Math.ceil(s/n.length),p=a.chunk(u,c);n.forEach((function(e,r){p[r].map((function(r){P(r,"minduration",e),P(r,"maxduration",e)}))}))}else u.map((function(e){return P(e,"maxduration",o)}));return u}(t,e),n=S.tags.filter((function(r){return r.uuid!==e.bidId}));S.tags=[].concat(v(n),v(r))}));var x=a.deepAccess(e[0],"userId.criteoId");if(x){var C=[];C.push({provider:"criteo",user_id:x}),S.tpuids=C}return function(e,r){var t=[];if(e.tags.length>15){var n=a.deepClone(e);a.chunk(e.tags,15).forEach((function(e){n.tags=e;var a=JSON.stringify(n);t.push({method:"POST",url:b,data:a,bidderRequest:r})}))}else{var i=JSON.stringify(e);t={method:"POST",url:b,data:i,bidderRequest:r}}return t}(S,r)},interpretResponse:function(e,r){var t=this,i=r.bidderRequest;e=e.body;var d=[];if(!e||e.error){var u="in response for ".concat(i.bidderCode," adapter");return e&&e.error&&(u+=": ".concat(e.error)),a.logError(u),d}if(e.tags&&e.tags.forEach((function(e){var r,u=(r=e)&&r.ads&&r.ads.length&&c()(r.ads,(function(e){return e.rtb}));if(u&&0!==u.cpm&&l()(t.supportedMediaTypes,u.ad_type)){var p=function(e,r,t){var i=a.getBidRequest(e.uuid,[t]),d={requestId:e.uuid,cpm:r.cpm,creativeId:r.creative_id,dealId:r.deal_id,currency:"USD",netRevenue:!0,ttl:300,adUnitCode:i.adUnitCode,appnexus:{buyerMemberId:r.buyer_member_id,dealPriority:r.deal_priority,dealCode:r.deal_code}};r.advertiser_id&&(d.meta=g({},d.meta,{advertiserId:r.advertiser_id}));if(r.rtb.video){switch(g(d,{width:r.rtb.video.player_width,height:r.rtb.video.player_height,vastImpUrl:r.notify_url,ttl:3600}),a.deepAccess(i,"mediaTypes.video.context")){case o.a:var u=Object(s.getIabSubCategory)(i.bidder,r.brand_category_id);d.meta=g({},d.meta,{iabSubCatId:u});var p=r.rtb.dealPriority;d.video={context:o.a,durationSeconds:Math.floor(r.rtb.video.duration_ms/1e3),dealTier:p},d.vastUrl=r.rtb.video.asset_url;break;case m.b:if(d.adResponse=e,d.adResponse.ad=d.adResponse.ads[0],d.adResponse.ad.video=d.adResponse.ad.rtb.video,d.vastXml=r.rtb.video.content,r.renderer_url){var l=c()(t.bids,(function(r){return r.bidId===e.uuid})),f=a.deepAccess(l,"renderer.options");d.renderer=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.a.install({id:r.renderer_id,url:r.renderer_url,config:t,loaded:!1,adUnitCode:e});try{i.setRender(q)}catch(e){a.logWarn("Prebid Error calling setRender on renderer",e)}return i.setEventHandlers({impression:function(){return a.logMessage("AppNexus outstream video impression event")},loaded:function(){return a.logMessage("AppNexus outstream video loaded event")},ended:function(){a.logMessage("AppNexus outstream renderer video event"),document.querySelector("#".concat(e)).style.display="none"}}),i}(d.adUnitCode,r,f)}break;case m.a:d.vastUrl=r.notify_url+"&redir="+encodeURIComponent(r.rtb.video.asset_url)}}else if(r.rtb[o.c]){var v=r.rtb[o.c],b=r.viewability.config.replace("src=","data-src="),y=v.javascript_trackers;null==y?y=b:a.isStr(y)?y=[y,b]:y.push(b),d[o.c]={title:v.title,body:v.desc,body2:v.desc2,cta:v.ctatext,rating:v.rating,sponsoredBy:v.sponsored,privacyLink:v.privacy_link,address:v.address,downloads:v.downloads,likes:v.likes,phone:v.phone,price:v.price,salePrice:v.saleprice,clickUrl:v.link.url,displayUrl:v.displayurl,clickTrackers:v.link.click_trackers,impressionTrackers:v.impression_trackers,javascriptTrackers:y},v.main_img&&(d.native.image={url:v.main_img.url,height:v.main_img.height,width:v.main_img.width}),v.icon&&(d.native.icon={url:v.icon.url,height:v.icon.height,width:v.icon.width})}else{g(d,{width:r.rtb.banner.width,height:r.rtb.banner.height,ad:r.rtb.banner.content});try{var h=r.rtb.trackers[0].impression_urls[0],_=a.createTrackPixelHtml(h);d.ad+=_}catch(e){a.logError("Error appending tracking pixel",e)}}return d}(e,u,i);p.mediaType=function(e){var r=e.ad_type;return r===o.d?o.d:r===o.c?o.c:o.b}(u),d.push(p)}})),e.debug&&e.debug.debug_info){var p="AppNexus Debug Auction for Prebid\n\n"+e.debug.debug_info;p=p.replace(/(<td>|<th>)/gm,"\t").replace(/(<\/td>|<\/th>)/gm,"\n").replace(/^<br>/gm,"").replace(/(<br>\n|<br>)/gm,"\n").replace(/<h1>(.*)<\/h1>/gm,"\n\n===== $1 =====\n\n").replace(/<h[2-6]>(.*)<\/h[2-6]>/gm,"\n\n*** $1 ***\n\n").replace(/(<([^>]+)>)/gim,""),a.logMessage("https://console.appnexus.com/docs/understanding-the-debug-auction"),a.logMessage(p)}return d},getMappingFileInfo:function(){return{url:"https://acdn.adnxs.com/prebid/appnexus-mapping/mappings.json",refreshInDays:7}},getUserSyncs:function(e){if(e.iframeEnabled)return[{type:"iframe",url:"https://acdn.adnxs.com/ib/static/usersync/v3/async_usersync.html"}]},transformBidParams:function(e,r){return e=a.convertTypes({member:"string",invCode:"string",placementId:"number",keywords:a.transformBidderParamKeywords},e),r&&(e.use_pmt_rule="boolean"==typeof e.usePaymentRule&&e.usePaymentRule,e.usePaymentRule&&delete e.usePaymentRule,S(e.keywords)&&e.keywords.forEach(w),Object.keys(e).forEach((function(r){var t=a.convertCamelToUnderscore(r);t!==r&&(e[t]=e[r],delete e[r])}))),e},onBidWon:function(e){e.native&&function(e){var r=function(e){var r;if(a.isStr(e)&&x(e))r=e;else if(a.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];x(n)&&(r=n)}return r}(e.native.javascriptTrackers);if(r)for(var t="pbjs_adid="+e.adId+";pbjs_auc="+e.adUnitCode,n=function(e){var r=e.indexOf('src="')+5,t=e.indexOf('"',r);return e.substring(r,t)}(r),i=n.replace("dom_id=%native_dom_id%",t),s=document.getElementsByTagName("iframe"),o=!1,d=0;d<s.length&&!o;d++){var u=s[d];try{var c=u.contentDocument||u.contentWindow.document;if(c)for(var p=c.getElementsByTagName("script"),l=0;l<p.length&&!o;l++){var m=p[l];m.getAttribute("data-src")==n&&(m.setAttribute("src",i),m.setAttribute("data-src",""),m.removeAttribute&&m.removeAttribute("data-src"),o=!0)}}catch(e){if(!(e instanceof DOMException&&"SecurityError"===e.name))throw e}}}(e)}};function S(e){return!!(a.isArray(e)&&e.length>0)}function w(e){S(e.value)&&""===e.value[0]&&delete e.value}function x(e){var r=e.match(k),t=null!=r&&r.length>=1,n=e.match("trk.js"),a=null!=n&&n.length>=1;return e.startsWith("<script")&&a&&t}function R(e){var r,t,n={};if(n.sizes=C(e.sizes),n.primary_size=n.sizes[0],n.ad_types=[],n.uuid=e.bidId,e.params.placementId?n.id=parseInt(e.params.placementId,10):n.code=e.params.invCode,n.allow_smaller_sizes=e.params.allowSmallerSizes||!1,n.use_pmt_rule=e.params.usePaymentRule||!1,n.prebid=!0,n.disable_psa=!0,e.params.reserve&&(n.reserve=e.params.reserve),e.params.position&&(n.position={above:1,below:2}[e.params.position]||0),e.params.trafficSourceCode&&(n.traffic_source_code=e.params.trafficSourceCode),e.params.privateSizes&&(n.private_sizes=C(e.params.privateSizes)),e.params.supplyType&&(n.supply_type=e.params.supplyType),e.params.pubClick&&(n.pubclick=e.params.pubClick),e.params.extInvCode&&(n.ext_inv_code=e.params.extInvCode),e.params.externalImpId&&(n.external_imp_id=e.params.externalImpId),!a.isEmpty(e.params.keywords)){var i=a.transformBidderParamKeywords(e.params.keywords);i.length>0&&i.forEach(w),n.keywords=i}if((e.mediaType===o.c||a.deepAccess(e,"mediaTypes.".concat(o.c)))&&(n.ad_types.push(o.c),0===n.sizes.length&&(n.sizes=C([1,1])),e.nativeParams)){var s=(r=e.nativeParams,t={},Object.keys(r).forEach((function(e){var n=A[e]&&A[e].serverName||A[e]||e,i=A[e]&&A[e].requiredParams;if(t[n]=g({},i,r[e]),(n===A.image.serverName||n===A.icon.serverName)&&t[n].sizes){var s=t[n].sizes;(a.isArrayOfNums(s)||a.isArray(s)&&s.length>0&&s.every((function(e){return a.isArrayOfNums(e)})))&&(t[n].sizes=C(t[n].sizes))}n===A.privacyLink&&(t.privacy_supported=!0)})),t);n[o.c]={layouts:[s]}}var u=a.deepAccess(e,"mediaTypes.".concat(o.d)),p=a.deepAccess(e,"mediaTypes.video.context");(e.mediaType===o.d||u)&&n.ad_types.push(o.d),(e.mediaType===o.d||u&&"outstream"!==p)&&(n.require_asset_url=!0),e.params.video&&(n.video={},Object.keys(e.params.video).filter((function(e){return l()(y,e)})).forEach((function(r){return n.video[r]=e.params.video[r]}))),e.renderer&&(n.video=g({},n.video,{custom_renderer_present:!0}));var m=c()(d.a.getAdUnits(),(function(r){return e.transactionId===r.transactionId}));return m&&m.mediaTypes&&m.mediaTypes.banner&&n.ad_types.push(o.b),0===n.ad_types.length&&delete n.ad_types,n}function C(e){var r=[],t={};if(a.isArray(e)&&2===e.length&&!a.isArray(e[0]))t.width=parseInt(e[0],10),t.height=parseInt(e[1],10),r.push(t);else if("object"===f(e))for(var n=0;n<e.length;n++){var i=e[n];(t={}).width=parseInt(i[0],10),t.height=parseInt(i[1],10),r.push(t)}return r}function E(e){return!!e.params.user}function B(e){return!!parseInt(e.params.member,10)}function O(e){if(e.params)return!!e.params.app}function U(e){return e.params&&e.params.app?!!e.params.app.id:!!e.params.app}function N(e){return!!e.debug}function j(e){return e.mediaTypes&&e.mediaTypes.video&&e.mediaTypes.video.context===o.a}function P(e,r,t){a.isEmpty(e.video)&&(e.video={}),e.video[r]=t}function q(e){e.renderer.push((function(){window.ANOutstreamVideo.renderAd({tagId:e.adResponse.tag_id,sizes:[e.getSize().split("x")],targetId:e.adUnitCode,uuid:e.adResponse.uuid,adResponse:e.adResponse,rendererOptions:e.renderer.getConfig()},z.bind(null,e))}))}function z(e,r,t){e.renderer.handleVideoEvent({id:r,eventName:t})}Object(s.registerBidder)(T)}}]);