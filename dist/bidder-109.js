(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{161:function(e,r,a){"use strict";a.r(r),a.d(r,"spec",(function(){return s}));var t=a(55),n=a(13),i=a(0),s={code:"cosmos",supportedMediaTypes:[n.b,n.d],_createUUID:function(){return""+(new Date).getTime()},_copyObject:function(e,r){e&&Object.keys(e).forEach((function(a){return r[a]=e[a]}))},_parse:function(e){try{if(e)return JSON.parse(e)}catch(e){i.logError("COSMOS: ","Exception: ",e)}return null},isBidRequestValid:function(e){return e&&e.params?i.isEmpty(e.params.publisherId)&&i.isNumber(e.params.publisherId)?!(e.hasOwnProperty("mediaTypes")&&e.mediaTypes.hasOwnProperty(n.d)&&(!e.mediaTypes.video.hasOwnProperty("mimes")||!i.isArray(e.mediaTypes.video.mimes)||0===e.mediaTypes.video.mimes.length))||(i.logError("COSMOS: ","mimes are mandatory for video bid request. Ad Unit: ",JSON.stringify(e)),!1):(i.logError("COSMOS: ","publisherId is mandatory and must be numeric. Ad Unit: ",JSON.stringify(e)),!1):(i.logError("COSMOS: ","nil/empty bid object"),!1)},buildRequests:function(e,r){return 0===e.length?[]:(r&&r.refererInfo&&(a=r.refererInfo),i.deepClone(e).map((function(e){var t=s._createRequest(e,a);if(t)return s._setGDPRParams(r,t),{method:"POST",url:"https://bid.cosmoshq.com/openrtb2/bids",data:JSON.stringify(t)}})));var a},interpretResponse:function(e,r){var a=e.body,t=[];try{if(a.seatbid){var o=a.cur?a.cur:"USD";a.seatbid.forEach((function(e){(e.bid?e.bid:[]).forEach((function(e){var a={requestId:e.impid,cpm:(parseFloat(e.price)||0).toFixed(2),width:e.w,height:e.h,creativeId:e.crid,currency:o,netRevenue:!1,ttl:300};e.dealid&&(a.dealId=e.dealid);var i=s._parse(r.data);i.imp&&i.imp.length>0&&i.imp.forEach((function(r){r.id===e.impid&&(r.banner?(a.ad=e.adm,a.mediaType=n.b):(a.width=e.hasOwnProperty("w")?e.w:r.video.w,a.height=e.hasOwnProperty("h")?e.h:r.video.h,a.vastXml=e.adm,a.mediaType=n.d))})),t.push(a)}))}))}}catch(e){i.logError("COSMOS: ","Exception: ",e)}return t},getUserSyncs:function(e,r){if(e.iframeEnabled)return[{type:"iframe",url:"https://sync.cosmoshq.com/js/v1/usersync.html"}];i.logWarn("COSMOS: Please enable iframe based user sync.")},_createRequest:function(e,r){var a={};try{a={id:s._createUUID(),imp:s._createImpressions(e),user:{},ext:{}};var t=s._createSite(e,r),n=s._createApp(e),o=s._createDevice(e);n&&(a.app=n),t&&(a.site=t),o&&(a.device=o)}catch(e){i.logError("COSMOS: ","Exception: ",e),a=null}return a},_createImpressions:function(e){var r=[],a=s._creatImpression(e);return a&&r.push(a),r},_creatImpression:function(e){if(e.hasOwnProperty("mediaTypes")){var r,a,t,i=e&&e.params?e.params:null,o={id:e.bidId?e.bidId:s._createUUID(),secure:"https:"===window.location.protocol?1:0,bidfloorcur:e.params.currency?e.params.currency:"USD"};for(t in i.bidFloor&&(o.bidfloor=i.bidFloor),i.tagId&&(o.tagid=i.tagId.toString()),e.mediaTypes)switch(t){case n.b:(r=s._createBanner(e))&&(o.banner=r);break;case n.d:(a=s._createVideo(e))&&(o.video=a)}return o.hasOwnProperty(n.b)||o.hasOwnProperty(n.d)?o:void 0}},_createBanner:function(e){if(i.deepAccess(e,"mediaTypes.banner")){var r={},a=e.mediaTypes.banner.sizes;if(a&&i.isArray(a)&&a.length>0){var t=[];r.w=a[0][0],r.h=a[0][1],a.forEach((function(e){t.push({w:e[0],h:e[1]})})),r.format=t}return s._copyObject(e.mediaTypes.banner,r),s._copyObject(e.params.banner,r),r}},_createVideo:function(e){if(i.deepAccess(e,"mediaTypes.video")){var r={},a=e.mediaTypes.video.playerSize;return a&&i.isArray(a)&&a.length>1&&(r.w=a[0],r.h=a[1]),s._copyObject(e.mediaTypes.video,r),s._copyObject(e.params.video,r),r}},_createSite:function(e,r){var a=e.params.site;if(a||!e.params.app){var t={};if(s._copyObject(a,t),r&&(r.referer&&(t.ref=encodeURIComponent(r.referer)),i.isArray(r.stack)&&r.stack.length>0)){t.page=encodeURIComponent(r.stack[0]);var n=document.createElement("a");n.href=t.page,t.domain=n.hostname}return t.publisher={id:e.params.publisherId.toString()},t}},_createApp:function(e){var r=e.params.app;if(r){var a={};return s._copyObject(r,a),a.publisher={id:e.params.publisherId.toString()},a}},_createDevice:function(e){var r={},a=e.params.device;return s._copyObject(a,r),r.dnt=i.getDNT()?1:0,r.ua=navigator.userAgent,r.language=navigator.language||navigator.browserLanguage||navigator.userLanguage||navigator.systemLanguage,r.w=window.screen.width||window.innerWidth,r.h=window.screen.height||window.innerHeigh,r},_setGDPRParams:function(e,r){e&&e.gdprConsent&&(r.regs={ext:{gdpr:e.gdprConsent.gdprApplies?1:0}},r.user={ext:{consent:e.gdprConsent.consentString}})}};Object(t.registerBidder)(s)}}]);