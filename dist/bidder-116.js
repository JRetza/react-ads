(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{171:function(t,i,e){"use strict";e.r(i),e.d(i,"surfaceTestHook",(function(){return v})),e.d(i,"digiTrustIdSubmodule",(function(){return p}));var n=e(0),r=e(22),u=e(7),c=0;function o(){return null!=window.DigiTrust&&DigiTrust.isClient}var s=function(){},l=function(t){return"function"==typeof t};function a(t){var i=new Date;i.setTime(i.getTime()+6048e5);var e="expires="+i.toUTCString();document.cookie="DigiTrust.v1.identity="+function(t){try{return"string"!=typeof t&&(t=JSON.stringify(t)),encodeURIComponent(btoa(t))}catch(i){return t}}(t)+"; "+e+"; path=/;SameSite=none;"}function d(t){var i=null;clearTimeout(c),c=0;var e={isClient:!0,isMock:!0,_internals:{callCount:0,initCallback:null},getUser:function(t,u){var c=!!l(u),o=c?u:s,d={success:!1},b=e._internals;b.callCount++;var m=function(t){if(b.callCount<=1&&l(b.initCallback))try{b.initCallback(t)}catch(t){n.logError("Exception in passed DigiTrust init callback")}};if(!f(t.member))return c?void o(d):d;if(null!=i)return c?void m(i):i;var T={success:function(t,e){var n={success:!0};try{a(t),n.identity=JSON.parse(t),i=n}catch(t){n.success=!1,delete n.identity}m(n)},fail:function(t,i){n.logError("DigiTrustId API error: "+t)}};return g.hasConsent(null,(function(t){var i;t&&(i=T,Object(r.a)("https://prebid.digitru.st/id/v1",{success:i.success,error:i.fail},null,{method:"GET"}))})),c?void 0:d}};t&&l(t.callback)&&(e._internals.initCallback=t.callback),window&&null==window.DigiTrust&&(window.DigiTrust=e)}var f=function(t){return!!(t&&t.length>0)||(n.logError("[DigiTrust Prebid Client Error] Missing member ID, add the member ID to the function call options"),!1)},g={hasConsent:function(t,i){var e;t=t||{consentTimeout:1500};var n=!1;void 0!==window.__cmp?(e=setTimeout((function(){n=!0,i(!1)}),t.consentTimeout),window.__cmp("ping",null,(function(t){if(t.gdprAppliesGlobally)window.__cmp("getVendorConsents",[64],(function(t){if(!n){clearTimeout(e);var r=t.vendorConsents[64];i(r)}}));else{if(n)return;clearTimeout(e),i(!0)}}))):i(!0)}},b=new function(t){var i=this;this.idObj=null;var e=null;function r(){if(null==i.idObj)return null;var t=i.configParams,e={data:null,expires:t&&t.storage&&t.storage.expires||60};return i.idObj&&i.idObj.success&&i.idObj.identity?e.data=i.idObj.identity:e.err="Failure getting id",e}this.userIdCallback=function(t){e=t,null!=i.idObj&&l(t)&&t(r())},this.retries=0,this.retryId=0,this.executeIdRequest=function(t){DigiTrust.getUser({member:"prebid"},(function(u){i.idObj=u;if(l(e)&&e(r()),t&&t.callback&&l(t.callback))try{t.callback(u)}catch(t){n.logError("Failure in DigiTrust executeIdRequest",t)}}))}};function m(t){return null==b.configParams&&(b.configParams=t),null==window.DigiTrust||o()?o()?(b.executeIdRequest(t),b.userIdCallback):(b.retries>=2?(d(t),b.executeIdRequest(t)):(0!=b.retryId&&clearTimeout(b.retryId),b.retryId=setTimeout((function(){m(t)}),100*(1+b.retries++))),b.userIdCallback):(function(t){n.logInfo("Digitrust Init");var i=window.DigiTrust;i&&!i.isClient&&null!=t?i.initialize(t.init,t.callback):null==i&&d(t)}(t),b.retryId=setTimeout((function(){m(t)}),100*(1+b.retries++)),b.userIdCallback)}var T={};function v(){return p._testHook=T,T}T.initDigitrustFacade=d,T.gdpr=g;var p={name:"digitrust",decode:function(t){try{return{digitrustid:t}}catch(t){n.logError("DigiTrust ID submodule decode error")}},getId:function(t){return{callback:m(t)}},_testInit:v};c=setTimeout((function(){0!=b.retryId||o()||m({member:"fallback",callback:s})}),1550),Object(u.e)("userId",p)}}]);