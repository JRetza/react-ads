(window.webpackJsonp=window.webpackJsonp||[]).push([[229],{305:function(e,t,r){"use strict";r.r(t),r.d(t,"spec",(function(){return l})),r.d(t,"_isInbounds",(function(){return g})),r.d(t,"_getPlatform",(function(){return y}));var n=r(55),i=r(0),s=r(13),o=r(2),a=r(16),c=r(29);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=Object(i.generateUUID)(),l={code:"sonobi",supportedMediaTypes:[s.b,s.d],isBidRequestValid:function(e){if(!e.params)return!1;if(!e.params.ad_unit&&!e.params.placement_id)return!1;if(!Object(i.deepAccess)(e,"mediaTypes.banner")&&!Object(i.deepAccess)(e,"mediaTypes.video"))return!1;if(Object(i.deepAccess)(e,"mediaTypes.banner")){if(!Object(i.deepAccess)(e,"mediaTypes.banner.sizes")&&!e.params.sizes)return!1}else if(Object(i.deepAccess)(e,"mediaTypes.video")){if("outstream"===Object(i.deepAccess)(e,"mediaTypes.video.context")&&!e.params.sizes)return!1;if("instream"===Object(i.deepAccess)(e,"mediaTypes.video.context")&&!Object(i.deepAccess)(e,"mediaTypes.video.playerSize"))return!1}return!0},buildRequests:function(e,t){var r=e.map((function(e){var t=function(e){if(e.params.ad_unit)return e.params.ad_unit;return e.params.placement_id}(e);return/^[\/]?[\d]+[[\/].+[\/]?]?$/.test(t)?(t="/"===t.charAt(0)?t:"/"+t,p({},"".concat(t,"|").concat(e.bidId),"".concat(f(e)).concat(m(e)))):/^[0-9a-fA-F]{20}$/.test(t)&&20===t.length?p({},e.bidId,"".concat(t,"|").concat(f(e)).concat(m(e))):void Object(i.logError)("The ad unit code or Sonobi Placement id for slot ".concat(e.bidId," is invalid"))})),n={};r.forEach((function(e){u(n,e)}));var s={key_maker:JSON.stringify(n),ref:t.refererInfo.referer,s:Object(i.generateUUID)(),pv:b,vp:y(),lib_name:"prebid",lib_v:"3.11.0",us:0};o.b.getConfig("userSync")&&o.b.getConfig("userSync").syncsPerBidder&&(s.us=o.b.getConfig("userSync").syncsPerBidder),c.a.canBidderRegisterSync("iframe","sonobi")?s.ius=1:s.ius=0,Object(i.deepAccess)(e[0],"params.hfa")&&(s.hfa=Object(i.deepAccess)(e[0],"params.hfa")),e[0].params.referrer&&(s.ref=e[0].params.referrer),t&&t.gdprConsent&&(s.gdpr=t.gdprConsent.gdprApplies?"true":"false",t.gdprConsent.consentString&&(s.consent_string=t.gdprConsent.consentString));var a=function(e){var t=(r=window.DigiTrust&&(o.b.getConfig("digiTrustId")||window.DigiTrust.getUser({member:e})),r&&r.success&&r.identity||null);var r;if(!t||t.privacy&&t.privacy.optout)return null;return t}("fhnS5drwmH");a&&(s.digid=a.id,s.digkeyv=a.keyv),e[0].schain&&(s.schain=JSON.stringify(e[0].schain)),Object(i.deepAccess)(e[0],"userId")&&Object.keys(e[0].userId).length>0&&(s.userid=JSON.stringify(e[0].userId));var d=e[0].params.keywords;return d&&(s.kw=d),t&&t.uspConsent&&(s.us_privacy=t.uspConsent),Object(i.isEmpty)(n)?null:{method:"GET",url:"https://apex.go.sonobi.com/trinity.json",withCredentials:!0,data:s,bidderRequests:e}},interpretResponse:function(e,t){var r=e.body,n=[],s=t.data.ref;return 0===Object.keys(r.slots).length||Object.keys(r.slots).forEach((function(e){var o=r.slots[e],c=e.split("|").slice(-1)[0],u=function(e,t){for(var r=0;r<e.length;r++)if(e[r].bidId===t)return e[r]}(t.bidderRequests,c),p=null;"video"===o.sbi_ct&&(p="video","outstream"===Object(i.deepAccess)(u,"mediaTypes.video.context")&&(p="outstream"));var b=v(p,s);if(o.sbi_aid&&o.sbi_mouse&&o.sbi_size){var l=d(o.sbi_size.split("x"),2),f=l[0],m=void 0===f?1:f,g=l[1],y=void 0===g?1:g,j={requestId:c,cpm:Number(o.sbi_mouse),width:Number(m),height:Number(y),ad:b(r.sbi_dc,o.sbi_aid),ttl:500,creativeId:o.sbi_crid||o.sbi_aid,aid:o.sbi_aid,netRevenue:!0,currency:"USD"};if(o.sbi_dozer&&(j.dealId=o.sbi_dozer),"video"===p)j.mediaType="video",j.vastUrl=b(r.sbi_dc,o.sbi_aid),delete j.ad,delete j.width,delete j.height;else if("outstream"===p&&u){j.mediaType="video",j.vastUrl=b(r.sbi_dc,o.sbi_aid),j.renderer=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.a.install({id:t.aid,url:"https://mtrx.go.sonobi.com/sbi_outstream_renderer.js",config:r,loaded:!1,adUnitCode:e});try{n.setRender(h)}catch(e){Object(i.logWarn)("Prebid Error calling setRender on renderer",e)}return n.setEventHandlers({impression:function(){return Object(i.logMessage)("Sonobi outstream video impression event")},loaded:function(){return Object(i.logMessage)("Sonobi outstream video loaded event")},ended:function(){Object(i.logMessage)("Sonobi outstream renderer video event")}}),n}(u.adUnitCode,j,Object(i.deepAccess)(u,"renderer.options"));var O=Object(i.deepAccess)(u,"params.sizes");Array.isArray(O)&&Array.isArray(O[0])&&(O=O[0]),O&&(j.width=O[0],j.height=O[1])}n.push(j)}})),n},getUserSyncs:function(e,t,r,n){var i=[];try{e.pixelEnabled&&t[0].body.sbi_px.forEach((function(e){i.push({type:e.type,url:e.url})}))}catch(e){}return i}};function f(e){return Object(i.deepAccess)(e,"mediaTypes.video")?"":e.params.sizes?Object(i.parseSizesInput)(e.params.sizes).join(","):Object(i.deepAccess)(e,"mediaTypes.banner.sizes")?Object(i.parseSizesInput)(Object(i.deepAccess)(e,"mediaTypes.banner.sizes")).join(","):e.sizes?Object(i.parseSizesInput)(e.sizes).join(","):void 0}function m(e){return e.params.floor?"|f=".concat(e.params.floor):""}var v=function(e,t){return function(r,n){return"video"===e||"outstream"===e?function(e,t,r){return"https://".concat(e,"apex.go.sonobi.com/vast.xml?vid=").concat(t,"&ref=").concat(encodeURIComponent(r))}(r,n,t):'<script type="text/javascript" src="'+"https://".concat(r,"apex.go.sonobi.com/sbi.js?aid=").concat(n,"&as=null&ref=").concat(encodeURIComponent(t))+'"><\/script>'}};var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return e.innerWidth>=t&&e.innerWidth<r}};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=g(e),r={lt:768},n={lt:992,ge:768};return t(0,r.lt)?"mobile":t(n.ge,n.lt)?"tablet":"desktop"}function h(e){e.renderer.push((function(){var t=d(e.getSize().split("x"),2),r=t[0],n=t[1],i=new window.SbiOutstreamRenderer;i.init({vastUrl:e.vastUrl,height:n,width:r}),i.setRootElement(e.adUnitCode)}))}Object(n.registerBidder)(l)}}]);