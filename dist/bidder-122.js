(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{177:function(e,r,i){"use strict";i.r(r),i.d(r,"emxAdapter",(function(){return m})),i.d(r,"spec",(function(){return l}));var t=i(0),n=i(55),a=i(13),d=i(16),o=i(3),s=i.n(o),u=i(23);function p(){return(p=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e}).apply(this,arguments)}var c="https://js.brealtime.com/outstream/1.30.0/bundle.js",m={validateSizes:function(e){return t.isArray(e)&&void 0!==e[0]?e.every((function(e){return t.isArray(e)&&2===e.length})):(t.logWarn("emx_digital: Sizes should be an array"),!1)},checkVideoContext:function(e){return e&&e.mediaTypes&&e.mediaTypes.video&&e.mediaTypes.video.context&&("instream"===e.mediaTypes.video.context||"outstream"===e.mediaTypes.video.context)},buildBanner:function(e){var r=[];return r=e.mediaTypes&&e.mediaTypes.banner&&e.mediaTypes.banner.sizes?e.mediaTypes.banner.sizes:e.sizes,m.validateSizes(r)||(t.logWarn("emx_digital: could not detect mediaType banner sizes. Assigning to bid sizes instead"),r=e.sizes),{format:r.map((function(e){return{w:e[0],h:e[1]}})),w:r[0][0],h:r[0][1]}},formatVideoResponse:function(e,r,i){return e.vastXml=r.adm,i.bidRequest&&i.bidRequest.mediaTypes&&i.bidRequest.mediaTypes.video&&"outstream"===i.bidRequest.mediaTypes.video.context&&(e.renderer=m.createRenderer(e,{id:r.id,url:c})),e},isMobile:function(){return/(ios|ipod|ipad|iphone|android)/i.test(navigator.userAgent)},isConnectedTV:function(){return/(smart[-]?tv|hbbtv|appletv|googletv|hdmi|netcast\.tv|viera|nettv|roku|\bdtv\b|sonydtv|inettvbrowser|\btv\b)/i.test(navigator.userAgent)},getDevice:function(){return{ua:navigator.userAgent,js:1,dnt:"yes"===navigator.doNotTrack||"1"===navigator.doNotTrack||"1"===navigator.msDoNotTrack?1:0,h:screen.height,w:screen.width,devicetype:m.isMobile()?1:m.isConnectedTV()?3:2,language:navigator.language||navigator.browserLanguage||navigator.userLanguage||navigator.systemLanguage}},cleanProtocols:function(e){return e.protocols&&s()(e.protocols,7)&&(t.logWarn("emx_digital: VAST 4.0 is currently not supported. This protocol has been filtered out of the request."),e.protocols=e.protocols.filter((function(e){return 7!==e}))),e},outstreamRender:function(e){e.renderer.push((function(){var r=e&&e.params&&e.params[0]&&e.params[0].video?e.params[0].video:{};window.emxVideoQueue=window.emxVideoQueue||[],window.queueEmxVideo({id:e.adUnitCode,adsResponses:e.vastXml,options:r}),window.emxVideoReady&&window.videojs&&window.emxVideoReady()}))},createRenderer:function(e,r){var i=d.a.install({id:r.id,url:c,loaded:!1});try{i.setRender(m.outstreamRender)}catch(e){t.logWarn("Prebid Error calling setRender on renderer",e)}return i},buildVideo:function(e){var r=p(e.mediaTypes.video,e.params.video);return t.isArray(e.mediaTypes.video.playerSize[0])?(r.w=e.mediaTypes.video.playerSize[0][0],r.h=e.mediaTypes.video.playerSize[0][1]):(r.w=e.mediaTypes.video.playerSize[0],r.h=e.mediaTypes.video.playerSize[1]),m.cleanProtocols(r)},parseResponse:function(e){try{return decodeURIComponent(e.replace(/%(?![0-9][0-9a-fA-F]+)/g,"%25"))}catch(e){t.logError("emx_digitalBidAdapter","error",e)}},getReferrer:function(){try{return window.top.document.referrer}catch(e){return document.referrer}},getSite:function(e){return{domain:Object(u.c)(e.referer).hostname,page:e.referer,ref:m.getReferrer()}},getGdpr:function(e,r){return e.gdprConsent&&(r.regs={ext:{gdpr:!0===e.gdprConsent.gdprApplies?1:0}}),e.gdprConsent&&e.gdprConsent.gdprApplies&&(r.user={ext:{consent:e.gdprConsent.consentString}}),r}},l={code:"emx_digital",supportedMediaTypes:[a.b,a.d],isBidRequestValid:function(e){if(!e||!e.params)return t.logWarn("emx_digital: Missing bid or bid params."),!1;if("emx_digital"!==e.bidder)return t.logWarn('emx_digital: Must use "emx_digital" as bidder code.'),!1;if(!e.params.tagid||!t.isStr(e.params.tagid))return t.logWarn("emx_digital: Missing tagid param or tagid present and not type String."),!1;var r;if(e.mediaTypes&&e.mediaTypes.banner){if(r=e.mediaTypes.banner.sizes?e.mediaTypes.banner.sizes:e.sizes,!m.validateSizes(r))return t.logWarn("emx_digital: Missing sizes in bid"),!1}else if(e.mediaTypes&&e.mediaTypes.video){if(!m.checkVideoContext(e))return t.logWarn("emx_digital: Missing video context: instream or outstream"),!1;if(!e.mediaTypes.video.playerSize)return t.logWarn("emx_digital: Missing video playerSize"),!1}return!0},buildRequests:function(e,r){var i=[],n="https://hb.emxdgt.com?t="+(r.timeout||"")+"&ts="+Date.now()+"&src=pbjs",a=location.protocol.indexOf("https")>-1?1:0,d=m.getDevice(),o=m.getSite(r.refererInfo);t._each(e,(function(e){var r=t.getBidIdParameter("tagid",e.params),n=parseFloat(t.getBidIdParameter("bidfloor",e.params))||0,d=!!e.mediaTypes.video,o=p({id:e.bidId,tid:e.transactionId,tagid:r,secure:a},d?{video:m.buildVideo(e)}:{banner:m.buildBanner(e)},n>0?{bidfloor:n,bidfloorcur:"USD"}:{});i.push(o)}));var s={id:r.auctionId,imp:i,device:d,site:o,cur:"USD",version:"1.5.0"};return s=m.getGdpr(r,p({},s)),r&&r.uspConsent&&(s.us_privacy=r.uspConsent),{method:"POST",url:n,data:JSON.stringify(s),options:{withCredentials:!0},bidderRequest:r}},interpretResponse:function(e,r){var i=[],t=e.body||{};return t.seatbid&&t.seatbid.length>0&&t.seatbid[0].bid&&t.seatbid.forEach((function(e){e=e.bid[0];var t=!1,n=m.parseResponse(e.adm)||"",d={requestId:e.id,cpm:e.price,width:e.w,height:e.h,creativeId:e.crid||e.id,dealId:e.dealid||null,currency:"USD",netRevenue:!0,ttl:e.ttl,ad:n};e.adm&&e.adm.indexOf("<?xml version=")>-1&&(t=!0,d=m.formatVideoResponse(d,p({},e),r)),d.mediaType=t?a.d:a.b,i.push(d)})),i},getUserSyncs:function(e){var r=[];return e.iframeEnabled&&r.push({type:"iframe",url:"https://biddr.brealtime.com/check.html"}),r}};Object(n.registerBidder)(l)}}]);