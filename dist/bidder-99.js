(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{12:function(e,r,a){"use strict";a.r(r),a.d(r,"resetUserSync",(function(){return i})),a.d(r,"spec",(function(){return o})),a.d(r,"hasValidSupplyChainParams",(function(){return d}));var n=a(279),t=a(280),s=!1;function i(){s=!1}var o={code:"aardvark",aliases:["adsparc","safereach"],isBidRequestValid:function(e){return"string"==typeof e.params.ai&&!!e.params.ai.length&&"string"==typeof e.params.sc&&!!e.params.sc.length},buildRequests:function(e,r){var a,t=[],s=[],i={},d=r.refererInfo.referer,p=[],c="",u=window.innerWidth,l=window.innerHeight;try{var h=n.getWindowTop();h.rtkcategories&&Array.isArray(h.rtkcategories)&&(p=h.rtkcategories),u=h.innerWidth,l=h.innerHeight}catch(e){}return n.isStr(n.deepAccess(e,"0.userId.tdid"))&&(c=e[0].userId.tdid),a=o.serializeSupplyChain(n.deepAccess(e,"0.schain")),n._each(e,(function(e){var s=i[e.params.ai];s||(s={shortCodes:[],payload:{version:1,jsonp:!1,rtkreferer:d,w:u,h:l},endpoint:"bidder.rtk.io"},c&&(s.payload.tdid=c),a&&(s.payload.schain=a),p&&p.length&&(s.payload.categories=p.slice(0)),e.params.categories&&e.params.categories.length&&(s.payload.categories=s.payload.categories||[],n._each(e.params.categories,(function(e){s.payload.categories.push(e)}))),r.gdprConsent&&(s.payload.gdpr=!1,"boolean"==typeof r.gdprConsent.gdprApplies&&(s.payload.gdpr=r.gdprConsent.gdprApplies),s.payload.gdpr&&(s.payload.consent=r.gdprConsent.consentString)),i[e.params.ai]=s,t.push(e.params.ai)),r.uspConsent&&(s.payload.us_privacy=r.uspConsent),s.shortCodes.push(e.params.sc),s.payload[e.params.sc]=e.bidId,"string"==typeof e.params.host&&e.params.host.length&&e.params.host!==s.endpoint&&(s.endpoint=e.params.host)})),n._each(t,(function(e){var a=i[e];s.push({method:"GET",url:"https://".concat(a.endpoint,"/").concat(e,"/").concat(a.shortCodes.join("_"),"/aardvark"),data:a.payload,bidderRequest:r})})),s},interpretResponse:function(e,r){var a=[];return Array.isArray(e.body)||(e.body=[e.body]),n._each(e.body,(function(e){var r=+(e.cpm||0);if(r){var t={requestId:e.cid,cpm:r,width:e.width||0,height:e.height||0,currency:e.currency?e.currency:"USD",netRevenue:!e.netRevenue||e.netRevenue,ttl:e.ttl?e.ttl:300,creativeId:e.creativeId||0};switch(e.hasOwnProperty("dealId")&&(t.dealId=e.dealId),e.hasOwnProperty("ex")&&(t.ex=e.ex),e.media){case"banner":t.ad=e.adm+n.createTrackPixelHtml(decodeURIComponent(e.nurl));break;default:return n.logError("bad Aardvark response (media)",e)}a.push(t)}})),a},getUserSyncs:function(e,r,a,t){var i=[],o=[],d=!1;if(a&&"boolean"==typeof a.gdprApplies&&(d=a.gdprApplies),!e.iframeEnabled)return n.logWarn("Aardvark: Please enable iframe based user sync."),i;if(s)return i;s=!0,d&&(o.push(["g","1"]),o.push(["c",a.consentString])),t&&o.push(["us_privacy",t]);var p="";return o.length&&(p="?"+o.map((function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&")),i.push({type:"iframe",url:"https://".concat("sync.rtk.io","/cs").concat(p)}),i},serializeSupplyChain:function(e){return d(e)?"".concat(e.ver,",").concat(e.complete,"!").concat(o.serializeSupplyChainNodes(e.nodes)):""},serializeSupplyChainNodes:function(e){var r=["asi","sid","hp","rid","name","domain"];return e.map((function(e){return r.map((function(r){return encodeURIComponent(e[r]||"")})).join(",")})).join("!")}};function d(e){if(!e||!e.nodes)return!1;var r=["asi","sid","hp"],a=e.nodes.reduce((function(e,a){return e?r.every((function(e){return a[e]})):e}),!0);return a||n.logError("Aardvark: required schain params missing"),a}Object(t.registerBidder)(o)}}]);