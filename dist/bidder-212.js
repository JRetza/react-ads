(window.webpackJsonp=window.webpackJsonp||[]).push([[212],{284:function(e,r,t){"use strict";t.r(r),t.d(r,"FASTLANE_ENDPOINT",(function(){return p})),t.d(r,"VIDEO_ENDPOINT",(function(){return l})),t.d(r,"SYNC_ENDPOINT",(function(){return f})),t.d(r,"spec",(function(){return g})),t.d(r,"hasVideoMediaType",(function(){return _})),t.d(r,"masSizeOrdering",(function(){return A})),t.d(r,"determineRubiconVideoSizeId",(function(){return S})),t.d(r,"getPriceGranularity",(function(){return C})),t.d(r,"hasValidVideoParams",(function(){return j})),t.d(r,"hasValidSupplyChainParams",(function(){return k})),t.d(r,"encodeParam",(function(){return w})),t.d(r,"resetUserSync",(function(){return R}));var i=t(0),n=t(55),o=t(2),a=t(13);function s(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],i=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(t.push(a.value),!r||t.length!==r);i=!0);}catch(e){n=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(){return(d=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}function c(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p="https://fastlane.rubiconproject.com/a/api/fastlane.json",l="https://prebid-server.rubiconproject.com/openrtb2/auction",f="https://eus.rubiconproject.com/usync.html",m={FASTLANE:{id:"dt.id",keyv:"dt.keyv",pref:"dt.pref"},PREBID_SERVER:{id:"id",keyv:"keyv"}},v={1:"468x60",2:"728x90",5:"120x90",8:"120x600",9:"160x600",10:"300x600",13:"200x200",14:"250x250",15:"300x250",16:"336x280",17:"240x400",19:"300x100",31:"980x120",32:"250x360",33:"180x500",35:"980x150",37:"468x400",38:"930x180",39:"750x100",40:"750x200",41:"750x300",42:"2x4",43:"320x50",44:"300x50",48:"300x300",53:"1024x768",54:"300x1050",55:"970x90",57:"970x250",58:"1000x90",59:"320x80",60:"320x150",61:"1000x1000",64:"580x500",65:"640x480",66:"930x600",67:"320x480",68:"1800x1000",72:"320x320",73:"320x160",78:"980x240",79:"980x300",80:"980x400",83:"480x300",94:"970x310",96:"970x210",101:"480x320",102:"768x1024",103:"480x280",105:"250x800",108:"320x240",113:"1000x300",117:"320x100",125:"800x250",126:"200x600",144:"980x600",145:"980x150",152:"1000x250",156:"640x320",159:"320x250",179:"250x600",195:"600x300",198:"640x360",199:"640x200",213:"1030x590",214:"980x360",221:"1x1",229:"320x180",232:"580x400",234:"6x6",251:"2x2",257:"400x600",264:"970x1000",265:"1920x1080",274:"1800x200",278:"320x500",282:"320x400",288:"640x380"};i._each(v,(function(e,r){return v[e]=r}));var g={code:"rubicon",supportedMediaTypes:[a.b,a.d],isBidRequestValid:function(e){if("object"!==u(e.params))return!1;for(var r=0,t=["accountId","siteId","zoneId"];r<t.length;r++)if(e.params[t[r]]=parseInt(e.params[t[r]]),isNaN(e.params[t[r]]))return i.logError("Rubicon: wrong format of accountId or siteId or zoneId."),!1;var n=I(e,!0);return!!n&&("video"!==n||j(e))},buildRequests:function(e,r){var t=[],n=e.filter((function(e){return"video"===I(e)})).map((function(e){e.startTime=(new Date).getTime();var t={id:e.transactionId,test:o.b.getConfig("debug")?1:0,cur:["USD"],source:{tid:e.transactionId},tmax:o.b.getConfig("TTL")||1e3,imp:[{exp:300,id:e.adUnitCode,secure:1,ext:c({},e.bidder,e.params),video:i.deepAccess(e,"mediaTypes.video")||{}}],ext:{prebid:{cache:{vastxml:{returnCreative:!1}},targeting:{includewinners:!0,includebidderkeys:!1,pricegranularity:C(o.b)}}}};"rubicon"!==e.bidder&&(t.ext.prebid.aliases=c({},e.bidder,"rubicon"));var n=parseFloat(i.deepAccess(e,"params.floor"));isNaN(n)||(t.imp[0].bidfloor=n),t.imp[0].ext[e.bidder].video.size_id=S(e),function(e,r,t){if(!e)return;"object"===u(o.b.getConfig("app"))?e.app=o.b.getConfig("app"):e.site={page:y(r,t)};"object"===u(o.b.getConfig("device"))&&(e.device=o.b.getConfig("device"));r.params.video.language&&["site","device"].forEach((function(t){e[t]&&(e[t].content=d({language:r.params.video.language},e[t].content))}))}(t,e,r),function(e,r){"object"===u(e.imp[0].video)&&void 0===e.imp[0].video.skip&&(e.imp[0].video.skip=r.params.video.skip);"object"===u(e.imp[0].video)&&void 0===e.imp[0].video.skipafter&&(e.imp[0].video.skipafter=r.params.video.skipdelay);"object"===u(e.imp[0].video)&&void 0===e.imp[0].video.pos&&("atf"===r.params.position?e.imp[0].video.pos=1:"btf"===r.params.position&&(e.imp[0].video.pos=3));var t=x(r,"video");e.imp[0].video.w=t[0],e.imp[0].video.h=t[1]}(t,e);var a,s=b(e,"PREBID_SERVER");(s&&i.deepSetValue(t,"user.ext.digitrust",s),r.gdprConsent)&&("boolean"==typeof r.gdprConsent.gdprApplies&&(a=r.gdprConsent.gdprApplies?1:0),i.deepSetValue(t,"regs.ext.gdpr",a),i.deepSetValue(t,"user.ext.consent",r.gdprConsent.consentString));r.uspConsent&&i.deepSetValue(t,"regs.ext.us_privacy",r.uspConsent),e.userId&&"object"===u(e.userId)&&(e.userId.tdid||e.userId.pubcid||e.userId.lipb||e.userId.idl_env)&&(i.deepSetValue(t,"user.ext.eids",[]),e.userId.tdid&&t.user.ext.eids.push({source:"adserver.org",uids:[{id:e.userId.tdid,ext:{rtiPartner:"TDID"}}]}),e.userId.pubcid&&t.user.ext.eids.push({source:"pubcommon",uids:[{id:e.userId.pubcid}]}),e.userId.lipb&&e.userId.lipb.lipbid&&(t.user.ext.eids.push({source:"liveintent.com",uids:[{id:e.userId.lipb.lipbid}]}),t.user.ext.tpid={source:"liveintent.com",uid:e.userId.lipb.lipbid},Array.isArray(e.userId.lipb.segments)&&e.userId.lipb.segments.length&&i.deepSetValue(t,"rp.target.LIseg",e.userId.lipb.segments)),e.userId.idl_env&&t.user.ext.eids.push({source:"liveramp.com",uids:[{id:e.userId.idl_env}]})),!0===o.b.getConfig("coppa")&&i.deepSetValue(t,"regs.coppa",1),e.schain&&k(e.schain)&&i.deepSetValue(t,"source.ext.schain",e.schain);var p=d({},e.params.inventory,o.b.getConfig("fpd.context")),f=d({},e.params.visitor,o.b.getConfig("fpd.user"));if(!i.isEmpty(p)||!i.isEmpty(f)){var m={bidders:[r.bidderCode],config:{fpd:{}}};i.isEmpty(p)||(m.config.fpd.site=p),i.isEmpty(f)||(m.config.fpd.user=f),i.deepSetValue(t,"ext.prebid.bidderconfig.0",m)}var v=i.deepAccess(e,"fpd.context.pbAdSlot");return"string"==typeof v&&v&&i.deepSetValue(t.imp[0].ext,"context.data.adslot",v),e.storedAuctionResponse&&i.deepSetValue(t.imp[0],"ext.prebid.storedauctionresponse.id",e.storedAuctionResponse.toString()),{method:"POST",url:l,data:t,bidRequest:e}}));if(!0!==o.b.getConfig("rubicon.singleRequest"))t=n.concat(e.filter((function(e){return"banner"===I(e)})).map((function(e){var t=g.createSlotParams(e,r);return{method:"GET",url:p,data:g.getOrderedParams(t).reduce((function(e,r){var n=t[r];return i.isStr(n)&&""!==n||i.isNumber(n)?"".concat(e).concat(w(r,n),"&"):e}),"")+"slots=1&rand=".concat(Math.random()),bidRequest:e}})));else{var a=e.filter((function(e){return"banner"===I(e)})).reduce((function(e,r){return(e[r.params.siteId]=e[r.params.siteId]||[]).push(r),e}),{});t=n.concat(Object.keys(a).reduce((function(e,t){var n,o;return(n=a[t],o=10,n.map((function(e,r){return r%o==0?n.slice(r,r+o):null})).filter((function(e){return e}))).forEach((function(t){var n=g.combineSlotUrlParams(t.map((function(e){return g.createSlotParams(e,r)})));e.push({method:"GET",url:p,data:g.getOrderedParams(n).reduce((function(e,r){var t=n[r];return i.isStr(t)&&""!==t||i.isNumber(t)?"".concat(e).concat(w(r,t),"&"):e}),"")+"slots=".concat(t.length,"&rand=").concat(Math.random()),bidRequest:t})})),e}),[]))}return t},getOrderedParams:function(e){var r=/^tg_v/,t=/^tg_i/,i=["account_id","site_id","zone_id","size_id","alt_size_ids","p_pos","gdpr","gdpr_consent","us_privacy","rp_schain","tpid_tdid","tpid_liveintent.com","tg_v.LIseg","dt.id","dt.keyv","dt.pref","rf","p_geo.latitude","p_geo.longitude","kw"].concat(Object.keys(e).filter((function(e){return r.test(e)}))).concat(Object.keys(e).filter((function(e){return t.test(e)}))).concat(["tk_flint","x_source.tid","x_source.pchain","p_screen_res","rp_floor","rp_secure","tk_user_key"]);return i.concat(Object.keys(e).filter((function(e){return-1===i.indexOf(e)})))},combineSlotUrlParams:function(e){if(1===e.length)return e[0];var r=e.reduce((function(r,t,i){return Object.keys(t).forEach((function(n){r.hasOwnProperty(n)||(r[n]=new Array(e.length)),r[n].splice(i,1,t[n])})),r}),{}),t=new RegExp("^([^;]*)(;\\1)+$");return Object.keys(r).forEach((function(e){var i=r[e].join(";"),n=i.match(t);r[e]=n?n[1]:i})),r},createSlotParams:function(e,r){e.startTime=(new Date).getTime();var t=e.params,n=x(e,"banner"),a=s(t.latLong||[],2),c=a[0],p=a[1],l=o.b.getConfig("rubicon.int_type"),f={account_id:t.accountId,site_id:t.siteId,zone_id:t.zoneId,size_id:n[0],alt_size_ids:n.slice(1).join(",")||void 0,rp_floor:(t.floor=parseFloat(t.floor))>.01?t.floor:.01,rp_secure:"1",tk_flint:"".concat(l||"pbjs_lite","_v3.11.0"),"x_source.tid":e.transactionId,"x_source.pchain":t.pchain,p_screen_res:[window.screen.width,window.screen.height].join("x"),tk_user_key:t.userId,"p_geo.latitude":isNaN(parseFloat(c))?void 0:parseFloat(c).toFixed(4),"p_geo.longitude":isNaN(parseFloat(p))?void 0:parseFloat(p).toFixed(4),"tg_fl.eid":e.code,rf:y(e,r)};f.p_pos="atf"===t.position||"btf"===t.position?t.position:"",e.userId&&(e.userId.tdid&&(f.tpid_tdid=e.userId.tdid),e.userId.lipb&&e.userId.lipb.lipbid&&(f["tpid_liveintent.com"]=e.userId.lipb.lipbid,Array.isArray(e.userId.lipb.segments)&&e.userId.lipb.segments.length&&(f["tg_v.LIseg"]=e.userId.lipb.segments.join(","))),e.userId.idl_env&&(f["tpid_liveramp.com"]=e.userId.idl_env)),r.gdprConsent&&("boolean"==typeof r.gdprConsent.gdprApplies&&(f.gdpr=Number(r.gdprConsent.gdprApplies)),f.gdpr_consent=r.gdprConsent.consentString),r.uspConsent&&(f.us_privacy=encodeURIComponent(r.uspConsent));var m=d({},t.visitor,o.b.getConfig("fpd.user"));Object.keys(m).forEach((function(e){null!=m[e]&&"keywords"!==e&&(f["tg_v.".concat(e)]="object"!==u(m[e])||Array.isArray(m[e])?m[e].toString():JSON.stringify(m[e]))}));var v=d({},t.inventory,o.b.getConfig("fpd.context"));Object.keys(v).forEach((function(e){null!=v[e]&&"keywords"!==e&&(f["tg_i.".concat(e)]="object"!==u(v[e])||Array.isArray(v[e])?v[e].toString():JSON.stringify(v[e]))}));var h=(t.keywords||[]).concat(i.deepAccess(o.b.getConfig("fpd.user"),"keywords")||[],i.deepAccess(o.b.getConfig("fpd.context"),"keywords")||[]);f.kw=h.length?h.join(","):"";var _=i.deepAccess(e,"fpd.context.pbAdSlot");"string"==typeof _&&_&&(f["tg_i.dfp_ad_unit_code"]=_.replace(/^\/+/,""));var I=b(e,"FASTLANE");return d(f,I),!0===o.b.getConfig("coppa")&&(f.coppa=1),e.schain&&k(e.schain)&&(f.rp_schain=g.serializeSupplyChain(e.schain)),f},serializeSupplyChain:function(e){if(!k(e))return"";var r=e.ver,t=e.complete,i=e.nodes;return"".concat(r,",").concat(t,"!").concat(g.serializeSupplyChainNodes(i))},serializeSupplyChainNodes:function(e){var r=["asi","sid","hp","rid","name","domain"];return e.map((function(e){return r.map((function(r){return encodeURIComponent(e[r]||"")})).join(",")})).join("!")},interpretResponse:function(e,r){var t=r.bidRequest;if(!(e=e.body)||"object"!==u(e))return[];if(e.seatbid){var n=i.deepAccess(e,"ext.errors.rubicon");Array.isArray(n)&&n.length>0&&i.logWarn("Rubicon: Error in video response");var d=[];return e.seatbid.forEach((function(r){(r.bid||[]).forEach((function(n){var s={requestId:t.bidId,currency:e.cur||"USD",creativeId:n.crid,cpm:n.price||0,bidderCode:r.seat,ttl:300,netRevenue:!1!==o.b.getConfig("rubicon.netRevenue"),width:n.w||i.deepAccess(t,"mediaTypes.video.w")||i.deepAccess(t,"params.video.playerWidth"),height:n.h||i.deepAccess(t,"mediaTypes.video.h")||i.deepAccess(t,"params.video.playerHeight")};n.id&&(s.seatBidId=n.id),n.dealid&&(s.dealId=n.dealid);var c=i.deepAccess(e,"ext.responsetimemillis.rubicon");if(t&&c&&(t.serverResponseTimeMs=c),i.deepAccess(n,"ext.prebid.type")===a.d){s.mediaType=a.d;var p=i.deepAccess(n,"ext.prebid.targeting");p&&"object"===u(p)&&(s.adserverTargeting=p),n.ext.prebid.cache&&"object"===u(n.ext.prebid.cache.vastXml)&&n.ext.prebid.cache.vastXml.cacheId&&n.ext.prebid.cache.vastXml.url?(s.videoCacheKey=n.ext.prebid.cache.vastXml.cacheId,s.vastUrl=n.ext.prebid.cache.vastXml.url):p&&p.hb_uuid&&p.hb_cache_host&&p.hb_cache_path&&(s.videoCacheKey=p.hb_uuid,s.vastUrl="https://".concat(p.hb_cache_host).concat(p.hb_cache_path,"?uuid=").concat(p.hb_uuid)),n.adm&&(s.vastXml=n.adm),n.nurl&&(s.vastUrl=n.nurl),!s.vastUrl&&n.nurl&&(s.vastUrl=n.nurl)}else i.logWarn("Rubicon: video response received non-video media type");d.push(s)}))})),d}var c=e.ads;return"object"!==u(t)||Array.isArray(t)||"video"!==I(t)||"object"!==u(c)||(c=c[t.adUnitCode]),!Array.isArray(c)||c.length<1?[]:c.reduce((function(r,n,d){if("ok"!==n.status)return r;var c,p,l=Array.isArray(t)?t[d]:t;if(l&&"object"===u(l)){var f={requestId:l.bidId,currency:"USD",creativeId:n.creative_id||"".concat(n.network||"","-").concat(n.advertiser||""),cpm:n.cpm||0,dealId:n.deal,ttl:300,netRevenue:!1!==o.b.getConfig("rubicon.netRevenue"),rubicon:{advertiserId:n.advertiser,networkId:n.network},meta:{advertiserId:n.advertiser,networkId:n.network}};if(n.creative_type&&(f.mediaType=n.creative_type),n.creative_type===a.d)f.width=l.params.video.playerWidth,f.height=l.params.video.playerHeight,f.vastUrl=n.creative_depot_url,f.impression_id=n.impression_id,f.videoCacheKey=n.impression_id;else{f.ad=(c=n.script,p=n.impression_id,"<html>\n<head><script type='text/javascript'>inDapIF=true;<\/script></head>\n<body style='margin : 0; padding: 0;'>\n\x3c!-- Rubicon Project Ad Tag --\x3e\n<div data-rp-impression-id='".concat(p,"'>\n<script type='text/javascript'>").concat(c,"<\/script>\n</div>\n</body>\n</html>"));var m=s(v[n.size_id].split("x").map((function(e){return Number(e)})),2);f.width=m[0],f.height=m[1]}f.rubiconTargeting=(Array.isArray(n.targeting)?n.targeting:[]).reduce((function(e,r){return e[r.key]=r.values[0],e}),{rpfl_elemid:l.adUnitCode}),r.push(f)}else i.logError("Rubicon: bidRequest undefined at index position:".concat(d),t,e);return r}),[]).sort((function(e,r){return(r.cpm||0)-(e.cpm||0)}))},getUserSyncs:function(e,r,t,i){if(!T&&e.iframeEnabled){var n="";return t&&"string"==typeof t.consentString&&("boolean"==typeof t.gdprApplies?n+="?gdpr=".concat(Number(t.gdprApplies),"&gdpr_consent=").concat(t.consentString):n+="?gdpr_consent=".concat(t.consentString)),i&&(n+="".concat(n?"&":"?","us_privacy=").concat(encodeURIComponent(i))),T=!0,{type:"iframe",url:f+n}}},transformBidParams:function(e,r){return i.convertTypes({accountId:"number",siteId:"number",zoneId:"number"},e)}};function b(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!t||!m[t])return null;var n=m[t];function a(){var e=i.deepAccess(r,"userId.digitrustid.data");if(e)return e;var t=window.DigiTrust&&(o.b.getConfig("digiTrustId")||window.DigiTrust.getUser({member:"T9QSFKPDN9"}));return t&&t.success&&t.identity||null}var s=a();if(!s||s.privacy&&s.privacy.optout)return null;var d=(c(e={},n.id,s.id),c(e,n.keyv,s.keyv),e);return n.pref&&(d[n.pref]=0),d}function y(e,r){var t=o.b.getConfig("pageUrl");return e.params.referrer?t=e.params.referrer:t||(t=r.refererInfo.referer),e.params.secure?t.replace(/^http:/i,"https:"):t}function x(e,r){var t=e.params;if("video"===r){var n=[];return t.video&&t.video.playerWidth&&t.video.playerHeight?n=[t.video.playerWidth,t.video.playerHeight]:Array.isArray(i.deepAccess(e,"mediaTypes.video.playerSize"))&&1===e.mediaTypes.video.playerSize.length?n=e.mediaTypes.video.playerSize[0]:Array.isArray(e.sizes)&&e.sizes.length>0&&Array.isArray(e.sizes[0])&&e.sizes[0].length>1&&(n=e.sizes[0]),n}var o=[];return Array.isArray(t.sizes)?o=t.sizes:void 0!==i.deepAccess(e,"mediaTypes.banner.sizes")?o=h(e.mediaTypes.banner.sizes):Array.isArray(e.sizes)&&e.sizes.length>0?o=h(e.sizes):i.logWarn("Rubicon: no sizes are setup or found"),A(o)}function h(e){return i.parseSizesInput(e).reduce((function(e,r){var t=parseInt(v[r],10);return t&&e.push(t),e}),[])}function _(e){return"object"===u(i.deepAccess(e,"params.video"))&&void 0!==i.deepAccess(e,"mediaTypes.".concat(a.d))}function I(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _(e)?-1===["outstream","instream"].indexOf(i.deepAccess(e,"mediaTypes.".concat(a.d,".context")))?void(r&&i.logError("Rubicon: mediaTypes.video.context must be outstream or instream")):x(e,"video").length<2?void(r&&i.logError("Rubicon: could not determine the playerSize of the video")):(r&&i.logMessage("Rubicon: making video request for adUnit",e.adUnitCode),"video"):0===x(e,"banner").length?void(r&&i.logError("Rubicon: could not determine the sizes for banner request")):(r&&i.logMessage("Rubicon: making banner request for adUnit",e.adUnitCode),"banner")}function A(e){var r=[15,2,9];return e.sort((function(e,t){var i=r.indexOf(e),n=r.indexOf(t);return i>-1||n>-1?-1===i?1:-1===n?-1:i-n:e-t}))}function S(e){var r=parseInt(i.deepAccess(e,"params.video.size_id"));return isNaN(r)?"outstream"===i.deepAccess(e,"mediaTypes.".concat(a.d,".context"))?203:201:r}function C(e){return{ranges:{low:[{max:5,increment:.5}],medium:[{max:20,increment:.1}],high:[{max:20,increment:.01}],auto:[{max:5,increment:.05},{min:5,max:10,increment:.1},{min:10,max:20,increment:.5}],dense:[{max:3,increment:.01},{min:3,max:8,increment:.05},{min:8,max:20,increment:.5}],custom:e.getConfig("customPriceBucket")&&e.getConfig("customPriceBucket").buckets}[e.getConfig("priceGranularity")]}}function j(e){var r=!0,t=Object.prototype.toString.call([]),n=Object.prototype.toString.call(0),o={mimes:t,protocols:t,maxduration:n,linearity:n,api:t};return Object.keys(o).forEach((function(t){Object.prototype.toString.call(i.deepAccess(e,"mediaTypes.video."+t))!==o[t]&&(r=!1,i.logError("Rubicon: mediaTypes.video."+t+" is required and must be of type: "+o[t]))})),r}function k(e){var r=!1,t=["asi","sid","hp"];return e.nodes?((r=e.nodes.reduce((function(e,r){return e?t.every((function(e){return r[e]})):e}),!0))||i.logError("Rubicon: required schain params missing"),r):r}function w(e,r){return"rp_schain"===e?"rp_schain=".concat(r):"".concat(e,"=").concat(encodeURIComponent(r))}var T=!1;function R(){T=!1}Object(n.registerBidder)(g)}}]);