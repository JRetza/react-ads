(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{190:function(e,r,t){"use strict";t.r(r),t.d(r,"helper",(function(){return u})),t.d(r,"spec",(function(){return c}));var n=t(0),i=t(55),a=t(2),s=t(16),o=t(13);function d(){return(d=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var p="https://rtb.gamoshi.io",u={getTopFrame:function(){try{return window.top===window?1:0}catch(e){}return 0},startsWith:function(e,r){return e.substr(0,r.length)===r},getTopWindowDomain:function(e){var r=e.indexOf("://")+"://".length;return e.substring(r,e.indexOf("/",r)<0?e.length:e.indexOf("/",r))},getMediaType:function(e){return e.ext?e.ext.media_type?e.ext.media_type.toLowerCase():e.ext.vast_url?o.d:o.b:o.b}},c={code:"gamoshi",aliases:["gambid","cleanmedia","9MediaOnline","adtarget"],supportedMediaTypes:["banner","video"],isBidRequestValid:function(e){return!!e.params.supplyPartnerId&&n.isStr(e.params.supplyPartnerId)&&(!e.params.rtbEndpoint||n.isStr(e.params.rtbEndpoint))&&(!e.params.bidfloor||n.isNumber(e.params.bidfloor))&&(!e.params.adpos||n.isNumber(e.params.adpos))&&(!e.params.protocols||Array.isArray(e.params.protocols))&&(!e.params.instl||0===e.params.instl||1===e.params.instl)},buildRequests:function(e,r){var t=this;return e.map((function(i){var s=i.adUnitCode,c=i.auctionId,l=i.mediaTypes,f=i.params,m=i.sizes,h=i.transactionId,v=f.rtbEndpoint||p,y="".concat(v,"/r/").concat(f.supplyPartnerId,"/bidr?rformat=open_rtb&reqformat=rtb_json&bidder=prebid")+(f.query?"&"+f.query:""),b=a.b.getConfig("pageUrl")||r.refererInfo.referer,w={id:c,site:{domain:u.getTopWindowDomain(b),page:b,ref:r.refererInfo.referer},device:{ua:navigator.userAgent,dnt:n.getDNT()?1:0,h:screen.height,w:screen.width,language:navigator.language},imp:[],ext:{},user:{ext:{}},source:{ext:{}},regs:{ext:{}}},x=r.gdprConsent;x&&x.consentString&&x.gdprApplies&&(w.ext.gdpr_consent={consent_string:x.consentString,consent_required:x.gdprApplies},n.deepSetValue(w,"regs.ext.gdpr",!0===x.gdprApplies?1:0),n.deepSetValue(w,"user.ext.consent",x.consentString)),e[0].schain&&n.deepSetValue(w,"source.ext.schain",e[0].schain),r&&r.uspConsent&&n.deepSetValue(w,"regs.ext.us_privacy",r.uspConsent);var A={id:h,instl:1===f.instl?1:0,tagid:s,bidfloor:f.bidfloor||0,bidfloorcur:"USD",secure:1},T=f.favoredMediaType&&t.supportedMediaTypes.includes(f.favoredMediaType);if((!l||l.banner)&&(!T||f.favoredMediaType===o.b)){var I=d({},A,{banner:{w:m.length?m[0][0]:300,h:m.length?m[0][1]:250,pos:f.pos||0,topframe:n.inIframe()?0:1}});w.imp.push(I)}if(l&&l.video&&(!T||f.favoredMediaType===o.d)){var S=l.video.playerSize||m,C=d({},A,{video:{protocols:f.protocols||[1,2,3,4,5,6],pos:f.pos||0,ext:{context:l.video.context}}});n.isArray(S[0])?(C.video.w=S[0][0],C.video.h=S[0][1]):n.isNumber(S[0])?(C.video.w=S[0],C.video.h=S[1]):(C.video.w=300,C.video.h=250),w.imp.push(C)}var E=[];if(i&&i.userId&&(g(E,n.deepAccess(i,"userId.id5id"),"id5-sync.com","ID5ID"),g(E,n.deepAccess(i,"userId.tdid"),"adserver.org","TDID")),E.length>0&&(w.user.ext.eids=E),0!==w.imp.length)return{method:"POST",url:y,data:w,bidRequest:i}}))},interpretResponse:function(e,r){var t=e&&e.body;if(!t)return n.logError("empty response"),[];var i=t.seatbid.reduce((function(e,r){return e.concat(r.bid)}),[]),a=[];return i.forEach((function(e){var i={requestId:r.bidRequest.bidId,cpm:e.price,width:e.w,height:e.h,ttl:360,creativeId:e.crid||e.adid,netRevenue:!0,currency:e.cur||t.cur,mediaType:u.getMediaType(e)};if(n.deepAccess(r.bidRequest,"mediaTypes."+i.mediaType))if(i.mediaType===o.b)a.push(d({},i,{ad:e.adm}));else if(i.mediaType===o.d){var s=n.deepAccess(r.bidRequest,"mediaTypes.video.context");a.push(d({},i,{vastUrl:e.ext.vast_url,vastXml:e.adm,renderer:"outstream"===s?l(r.bidRequest,e):void 0}))}})),a},getUserSyncs:function(e,r,t,n){var i=[],a=!1,s="",o="";t&&"boolean"==typeof t.gdprApplies&&(a=t.gdprApplies);var d=a?1:0;a&&t.consentString&&(s=encodeURIComponent(t.consentString)),n&&(o=encodeURIComponent(n));var p={gdpr:d,consent:s,uspConsent:o};return r.forEach((function(e){if(e.body){var r=e.body;r.ext&&Array.isArray(r.ext.utrk)&&r.ext.utrk.forEach((function(e){var r=m(e.url,p);i.push({type:e.type,url:r})})),Array.isArray(r.seatbid)&&r.seatbid.forEach((function(e){Array.isArray(e.bid)&&e.bid.forEach((function(e){e.ext&&Array.isArray(e.ext.utrk)&&e.ext.utrk.forEach((function(e){var r=m(e.url,p);i.push({type:e.type,url:r})}))}))}))}})),i}};function l(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=s.a.install({url:e.params&&e.params.rendererUrl||r.ext&&r.ext.renderer_url||"https://s.gamoshi.io/video/latest/renderer.js",config:t,loaded:!1});try{i.setRender(f)}catch(e){n.logWarn("Prebid Error calling setRender on renderer",e)}return i}function f(e){e.renderer.push((function(){var r=e.adUnitCode+"/"+e.adId;window.GamoshiPlayer.renderAd({id:r,debug:window.location.href.indexOf("pbjsDebug")>=0,placement:document.getElementById(e.adUnitCode),width:e.width,height:e.height,events:{ALL_ADS_COMPLETED:function(){return window.setTimeout((function(){window.GamoshiPlayer.removeAd(r)}),300)}},vastUrl:e.vastUrl,vastXml:e.vastXml})}))}function g(e,r,t,i){n.isStr(r)&&e.push({source:t,uids:[{id:r,ext:{rtiPartner:i}}]})}function m(e,r){return e.replace("[GDPR]",r.gdpr).replace("[CONSENT]",r.consent).replace("[US_PRIVACY]",r.uspConsent)}Object(i.registerBidder)(c)}}]);